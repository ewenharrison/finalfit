<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2018-07-16" />

<title>kmeans with dplyr and broom</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">kmeans with dplyr and broom</h1>
<h4 class="date"><em>2018-07-16</em></h4>



<div id="tidying-k-means-clustering" class="section level1">
<h1>Tidying k-means clustering</h1>
<p>K-means clustering serves as a very useful example of tidy data, and especially the distinction between the three tidying functions: <code>tidy</code>, <code>augment</code>, and <code>glance</code>.</p>
<p>Let’s start by generating some random two-dimensional data with three clusters. Data in each cluster will come from a multivariate gaussian distribution, with different means for each cluster:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(purrr)
<span class="kw">library</span>(tibble)
<span class="kw">library</span>(tidyr)

<span class="kw">set.seed</span>(<span class="dv">27</span>)

centers &lt;-<span class="st"> </span><span class="kw">tibble</span>(
  <span class="dt">cluster =</span> <span class="kw">factor</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>), 
  <span class="dt">num_points =</span> <span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">50</span>),  <span class="co"># number points in each cluster</span>
  <span class="dt">x1 =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">3</span>),              <span class="co"># x1 coordinate of cluster center</span>
  <span class="dt">x2 =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="op">-</span><span class="dv">2</span>)              <span class="co"># x2 coordinate of cluster center</span>
)

labelled_points &lt;-<span class="st"> </span>centers <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">x1 =</span> <span class="kw">map2</span>(num_points, x1, rnorm),
    <span class="dt">x2 =</span> <span class="kw">map2</span>(num_points, x2, rnorm)
  ) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>num_points) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">unnest</span>(x1, x2)

<span class="kw">ggplot</span>(labelled_points, <span class="kw">aes</span>(x1, x2, <span class="dt">color =</span> cluster)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>This is an ideal case for k-means clustering. We’ll use the built-in <code>kmeans</code> function, which accepts a dataframe with all numeric columns as it’s primary argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">points &lt;-<span class="st"> </span>labelled_points <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>cluster)

kclust &lt;-<span class="st"> </span><span class="kw">kmeans</span>(points, <span class="dt">centers =</span> <span class="dv">3</span>)
kclust</code></pre></div>
<pre><code>## K-means clustering with 3 clusters of sizes 51, 101, 148
## 
## Cluster means:
##            x1        x2
## 1 -3.14292460 -2.000043
## 2  5.00401249 -1.045811
## 3  0.08853475  1.045461
## 
## Clustering vector:
##   [1] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
##  [36] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
##  [71] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 3 3 3 3 3
## [106] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
## [141] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
## [176] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 3 3 3 3 3 3 3 3 3 3 3
## [211] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 1 3
## [246] 3 3 3 3 3 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## [281] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
## 
## Within cluster sum of squares by cluster:
## [1] 108.8112 243.2092 298.9415
##  (between_SS / total_SS =  82.5 %)
## 
## Available components:
## 
## [1] &quot;cluster&quot;      &quot;centers&quot;      &quot;totss&quot;        &quot;withinss&quot;    
## [5] &quot;tot.withinss&quot; &quot;betweenss&quot;    &quot;size&quot;         &quot;iter&quot;        
## [9] &quot;ifault&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(kclust)</code></pre></div>
<pre><code>##              Length Class  Mode   
## cluster      300    -none- numeric
## centers        6    -none- numeric
## totss          1    -none- numeric
## withinss       3    -none- numeric
## tot.withinss   1    -none- numeric
## betweenss      1    -none- numeric
## size           3    -none- numeric
## iter           1    -none- numeric
## ifault         1    -none- numeric</code></pre>
<p>The output is a list of vectors, where each component has a different length. There’s one of length 300: the same as our original dataset. There are a number of elements of length 3: <code>withinss</code>, <code>tot.withinss</code>, and <code>betweenss</code>- and <code>centers</code> is a matrix with 3 rows. And then there are the elements of length 1: <code>totss</code>, <code>tot.withinss</code>, <code>betweenss</code>, and <code>iter</code>.</p>
<p>These differing lengths have a deeper meaning when we want to tidy our dataset: they signify that each type of component communicates a <em>different kind</em> of information.</p>
<ul>
<li><code>cluster</code> (300 values) contains information about each <em>point</em></li>
<li><code>centers</code>, <code>withinss</code> and <code>size</code> (3 values) contain information about each <em>cluster</em></li>
<li><code>totss</code>, <code>tot.withinss</code>, <code>betweenss</code>, and <code>iter</code> (1 value) contain information about the <em>full clustering</em></li>
</ul>
<p>Which of these do we want to extract? There is no right answer: each of them may be interesting to an analyst. Because they communicate entirely different information (not to mention there’s no straightforward way to combine them), they are extracted by separate functions. <code>augment</code> adds the point classifications to the original dataset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(broom)

<span class="kw">augment</span>(kclust, points)</code></pre></div>
<pre><code>## # A tibble: 300 x 3
##       x1     x2 .cluster
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt;   
##  1  6.91 -2.74  2       
##  2  6.14 -2.45  2       
##  3  4.24 -0.946 2       
##  4  3.54  0.287 2       
##  5  3.91  0.408 2       
##  6  5.30 -1.58  2       
##  7  5.01 -1.77  2       
##  8  6.16 -1.68  2       
##  9  7.13 -2.17  2       
## 10  5.24 -2.42  2       
## # ... with 290 more rows</code></pre>
<p>The <code>tidy</code> function summarizes on a per-cluster level:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tidy</span>(kclust)</code></pre></div>
<pre><code>## # A tibble: 3 x 5
##        x1    x2  size withinss cluster
## *   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;fct&gt;  
## 1 -3.14   -2.00    51     109. 1      
## 2  5.00   -1.05   101     243. 2      
## 3  0.0885  1.05   148     299. 3</code></pre>
<p>And as it always does, the <code>glance</code> function extracts a single-row summary:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glance</span>(kclust)</code></pre></div>
<pre><code>## # A tibble: 1 x 4
##   totss tot.withinss betweenss  iter
##   &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt; &lt;int&gt;
## 1 3724.         651.     3073.     2</code></pre>
<div id="broom-and-dplyr-for-exploratory-clustering" class="section level2">
<h2>broom and dplyr for exploratory clustering</h2>
<p>While these summaries are useful, they would not have been too difficult to extract out from the dataset yourself. The real power comes from combining these analyses with dplyr.</p>
<p>Let’s say we want to explore the effect of different choices of <code>k</code>, from 1 to 9, on this clustering. First cluster the data 9 times, each using a different value of <code>k</code>, then create columns containing the tidied, glanced and augmented data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">kclusts &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">k =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(
    <span class="dt">kclust =</span> <span class="kw">map</span>(k, <span class="op">~</span><span class="kw">kmeans</span>(points, .x)),
    <span class="dt">tidied =</span> <span class="kw">map</span>(kclust, tidy),
    <span class="dt">glanced =</span> <span class="kw">map</span>(kclust, glance),
    <span class="dt">augmented =</span> <span class="kw">map</span>(kclust, augment, points)
  )

kclusts</code></pre></div>
<pre><code>## # A tibble: 9 x 5
##       k kclust       tidied           glanced          augmented         
##   &lt;int&gt; &lt;list&gt;       &lt;list&gt;           &lt;list&gt;           &lt;list&gt;            
## 1     1 &lt;S3: kmeans&gt; &lt;tibble [1 x 5]&gt; &lt;tibble [1 x 4]&gt; &lt;tibble [300 x 3]&gt;
## 2     2 &lt;S3: kmeans&gt; &lt;tibble [2 x 5]&gt; &lt;tibble [1 x 4]&gt; &lt;tibble [300 x 3]&gt;
## 3     3 &lt;S3: kmeans&gt; &lt;tibble [3 x 5]&gt; &lt;tibble [1 x 4]&gt; &lt;tibble [300 x 3]&gt;
## 4     4 &lt;S3: kmeans&gt; &lt;tibble [4 x 5]&gt; &lt;tibble [1 x 4]&gt; &lt;tibble [300 x 3]&gt;
## 5     5 &lt;S3: kmeans&gt; &lt;tibble [5 x 5]&gt; &lt;tibble [1 x 4]&gt; &lt;tibble [300 x 3]&gt;
## 6     6 &lt;S3: kmeans&gt; &lt;tibble [6 x 5]&gt; &lt;tibble [1 x 4]&gt; &lt;tibble [300 x 3]&gt;
## 7     7 &lt;S3: kmeans&gt; &lt;tibble [7 x 5]&gt; &lt;tibble [1 x 4]&gt; &lt;tibble [300 x 3]&gt;
## 8     8 &lt;S3: kmeans&gt; &lt;tibble [8 x 5]&gt; &lt;tibble [1 x 4]&gt; &lt;tibble [300 x 3]&gt;
## 9     9 &lt;S3: kmeans&gt; &lt;tibble [9 x 5]&gt; &lt;tibble [1 x 4]&gt; &lt;tibble [300 x 3]&gt;</code></pre>
<p>We can turn these into three separate datasets each representing a different type of data: Then tidy the clusterings three ways: using <code>tidy</code>, using <code>augment</code>, and using <code>glance</code>. Each of these goes into a separate dataset as they represent different types of data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">clusters &lt;-<span class="st"> </span>kclusts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">unnest</span>(tidied)

assignments &lt;-<span class="st"> </span>kclusts <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">unnest</span>(augmented)

clusterings &lt;-<span class="st"> </span>kclusts <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">unnest</span>(glanced, <span class="dt">.drop =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Now we can plot the original points, with each point colored according to the predicted cluster.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(assignments, <span class="kw">aes</span>(x1, x2)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> .cluster)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>k)
p1</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Already we get a good sense of the proper number of clusters (3), and how the k-means algorithm functions when k is too high or too low. We can then add the centers of the cluster using the data from <code>tidy</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p2 &lt;-<span class="st"> </span>p1 <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">data =</span> clusters, <span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">shape =</span> <span class="st">&quot;x&quot;</span>)
p2</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The data from <code>glance</code> fits a different but equally important purpose: it lets you view trends of some summary statistics across values of k. Of particular interest is the total within sum of squares, saved in the <code>tot.withinss</code> column.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(clusterings, <span class="kw">aes</span>(k, tot.withinss)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>()</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>This represents the variance within the clusters. It decreases as <code>k</code> increases, but one can notice a bend (or “elbow”) right at k=3. This bend indicates that additional clusters beyond the third have little value. (See <a href="http://web.stanford.edu/~hastie/Papers/gap.pdf">here</a> for a more mathematically rigorous interpretation and implementation of this method). Thus, all three methods of tidying data provided by broom are useful for summarizing clustering output.</p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
